---
title: "Fuel Prices From 2003 to 2023"
author: "Anonymous"
date: "2023-05-09"
output:
  pdf_document: default
  html_document: default
---
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
```{r,include=FALSE}

library(tidyverse)
library(readxl)
library(here)
library(ggplot2)
library(wesanderson)


```

## Research Question  
With recent unprecedented increases in the price of fuel worldwide it prompted the question of how have fuel prices for petrol and diesel changed in the last 20 years?  

## Data Origins  
Data was obtained from Government National Statistics, specifically reported by the Department for Energy Security and Net Zero. Data was the weekly road fuel prices table which reports the cost of unleaded petrol (ULSP) and unleaded diesel from 9/06/2013 until present day. 


```{r}

raw_data <- read_excel(here('Data','Weekly_Fuel_Prices.xlsx'), #loading data
                       skip=7, #skipping first 7 lines
                       sheet='All years') #selecting sheet titled "All Years"


```

Due to formatting of the Excel workbook I skipped the first 7 lines of the sheet in order for the data to load correctly and specify the page of the workbook I wanted data to be loaded from.


```{r,echo=FALSE}
library(knitr) #creating table for raw data
kable(raw_data[1:4, ],caption="Raw Data")

```

Link to [National Statistics Weekly Road Fuel Prices](https://www.gov.uk/government/statistics/weekly-road-fuel-prices)



## Data Preparation     
Steps I took to prepare the data were:   
1.  remove useless columns keeping just price per litre for diesel and petrol respectively  
2.  simplified variable names ULSP = petrol, ULSD = diesel 
 
```{r}

clean_data <- raw_data %>% 
  rename("Petrol"="ULSP:  Pump price (p/litre)",
         "Diesel"="ULSD: Pump price (p/litre)") %>% 
  select(Date,Petrol,Diesel)

```
  
Then I converted the data frame to long format in order to produce a graph
  
```{r}

df <- pivot_longer(clean_data, 
             -Date,
             names_to="Cat",
             values_to="Value")

```

```{r,echo=FALSE}

kable(df[1:6, ], caption="Processed Data")

```

## Visualisation  

```{r}

plot1 <- ggplot(df, aes(x=Date,y=Value,colour=Cat))+
  geom_line(linewidth=0.75)+ 
  labs(title="Fuel Prices Over the Past 20 Years",x="Date",y="Pence Per Litre",color=NULL)+
  scale_color_manual(limits=c("Petrol","Diesel"),values=wes_palette("Royal1",n=2))+
  scale_x_datetime(date_breaks="1 year",date_labels="%Y")+
  scale_y_continuous(breaks=c(80,100,120,140,160,180,200))+
  theme(axis.text.x=element_text(angle=50,hjust=1),legend.position = "bottom", plot.title=element_text(size=20,hjust=0.5),legend.text=element_text(size=10),legend.key.size=unit(1,"cm"))


#save output
ggsave("Fuel Prices 2003-2023.pdf", plot1, path=here("Plots")) 


```


```{r,echo=FALSE}

plot1

```

## Discussion
